C51 COMPILER V9.54   MAIN                                                                  07/08/2023 15:10:42 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\App\Keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ma
                    -in.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "LCD1602.h"
   3          #include "DS18B02.h"
   4          #include "Delay.h"
   5          #include "Key.h"
   6          #include "Timer0.h"
   7          #include "AT24C02.h"
   8          
   9          
  10          void main()
  11          {
  12   1        float temp ,T=0;
  13   1        unsigned char keynumber=0;
  14   1        char Hihgest,Lowest=0;
  15   1        
  16   1        Lowest=AT24C02ReadByte(0);//读取温度阈值数据
  17   1        Hihgest=AT24C02ReadByte(1);
  18   1        
  19   1        if(Hihgest>125||Lowest<-55||Lowest>=Hihgest)
  20   1        {
  21   2          Hihgest=30;//如果阈值非法，则设为默认值
  22   2          Lowest=20;
  23   2        }
  24   1        
  25   1        TempConvert();//上电先转换一次温度，防止第一次读数据错误
  26   1        Delay(1000);
  27   1        
  28   1        Timer0Init();
  29   1        LCD_Init();
  30   1        
  31   1        LCD_ShowString(1,1,"T:");
  32   1        LCD_ShowString(2,1,"H:");
  33   1        LCD_ShowString(2,8,"L:");
  34   1        while(1)
  35   1        {
  36   2          /*温度读取及显示*/
  37   2          TempConvert();
  38   2          temp=TempRead();
  39   2          T=temp;
  40   2          if(temp<0)
  41   2          {
  42   3            temp=-temp;
  43   3            LCD_ShowChar(1,3,'-');
  44   3          }
  45   2          else
  46   2          {
  47   3            LCD_ShowChar(1,3,'+');
  48   3          }
  49   2          LCD_ShowNum(1,4,temp,3);
  50   2          LCD_ShowChar(1,7,'.');
  51   2          LCD_ShowNum(1,8,(unsigned long)(temp*10000)%10000,4);
  52   2          
  53   2          /*阈值判断及显示*/
  54   2          keynumber=Key();
C51 COMPILER V9.54   MAIN                                                                  07/08/2023 15:10:42 PAGE 2   

  55   2          if(keynumber)
  56   2          {
  57   3            if(keynumber==1)
  58   3            {
  59   4              Hihgest++;
  60   4              if(Hihgest>125) Hihgest--;
  61   4            }
  62   3            if(keynumber==2)
  63   3            {
  64   4              Hihgest--;
  65   4              if(Hihgest<=Lowest)Hihgest++;
  66   4            }
  67   3            if(keynumber==3)
  68   3            {
  69   4              Lowest++;
  70   4              if(Hihgest<=Lowest)Lowest--;
  71   4            }
  72   3            if(keynumber==4)
  73   3            {
  74   4              Lowest--;
  75   4              if(Lowest<-55) Lowest++;
  76   4            }
  77   3          }
  78   2          
  79   2          LCD_ShowSignedNum(2,3,Hihgest,3);//显示阈值数据
  80   2          LCD_ShowSignedNum(2,10,Lowest,3);
  81   2          
  82   2          AT24C02WriteByte(0,Lowest);//写入到At24C02中保存
  83   2          Delay(5);
  84   2          AT24C02WriteByte(1,Hihgest);
  85   2          Delay(5);
  86   2          
  87   2          if(Hihgest<T) LCD_ShowChar(1,16,'H');//越界判断
  88   2          else if(T<Lowest) LCD_ShowChar(1,16,'L');
  89   2          else LCD_ShowChar(1,16,' ');
  90   2        }
  91   1      }
  92          
  93          void Timer0_Routine() interrupt 1
  94          {
  95   1        static unsigned int T0Count;
  96   1        TL0 = 0x18;   //设置定时初值
  97   1        TH0 = 0xFC;   //设置定时初值
  98   1        T0Count++;
  99   1        if(T0Count>=20)
 100   1        {
 101   2          T0Count=0;
 102   2          KeyLoop();  //每20ms调用一次按键驱动函数
 103   2        }
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    570    ----
   CONSTANT SIZE    =      9    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
