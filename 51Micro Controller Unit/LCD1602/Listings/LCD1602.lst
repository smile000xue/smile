C51 COMPILER V9.54   LCD1602                                                               07/11/2023 11:54:36 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\Objects\LCD1602.obj
COMPILER INVOKED BY: D:\App\Keil5\C51\BIN\C51.EXE LCD1602.c COMPACT OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\LCD1602.lst) TABS(2) OBJECT(.\Objects\LCD1602.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "Delay.h"
   3          
   4          //引脚定义
   5          sbit LCD_RS=P2^6;
   6          sbit LCD_WR=P2^5;
   7          sbit LCD_EN=P2^7;
   8          
   9          sfr Data_Port=0x80;
  10          
  11          /**
  12            * @brief  LCD1602写命令
  13            * @param  Command 要写入的命令
  14            * @retval 无
  15            */
  16          void LCD_WriteCommand(unsigned char Command)
  17          {
  18   1        LCD_RS=0;
  19   1        LCD_WR=0;
  20   1        Data_Port=Command;
  21   1        LCD_EN=1;
  22   1        Delay(1);
  23   1        LCD_EN=0;
  24   1        Delay(1);
  25   1      }
  26          
  27          /**
  28            * @brief  LCD1602写数据
  29            * @param  Data 要写入的数据
  30            * @retval 无
  31            */
  32          void LCD_WriteData(unsigned char Data)
  33          {
  34   1        LCD_RS=1;
  35   1        LCD_WR=0;
  36   1        Data_Port=Data;
  37   1        LCD_EN=1;
  38   1        Delay(1);
  39   1        LCD_EN=0;
  40   1        Delay(1);
  41   1      }
  42          
  43          
  44          /**
  45            * @brief  LCD1602初始化函数
  46            * @param  无
  47            * @retval 无
  48            */
  49          void LCD_Init(void)
  50          {
  51   1        LCD_WriteCommand(0x38);
  52   1        LCD_WriteCommand(0x0C);
  53   1        LCD_WriteCommand(0x06);
  54   1        LCD_WriteCommand(0x01);
C51 COMPILER V9.54   LCD1602                                                               07/11/2023 11:54:36 PAGE 2   

  55   1      }
  56          
  57          /**
  58            * @brief  LCD1602设置光标位置
  59            * @param  Line 行位置，范围：1~2
  60            * @param  Column 列位置，范围：1~16
  61            * @retval 无
  62            */
  63          void LCD_SetCursor(unsigned char Line,unsigned char Column)
  64          {
  65   1        if(Line==1)
  66   1        {
  67   2          LCD_WriteCommand(0x80|(Column-1));
  68   2        }
  69   1        else 
  70   1        {
  71   2          LCD_WriteCommand(0x80|(Column-1+0x40));
  72   2        }
  73   1      }
  74          
  75          /**
  76            * @brief  在LCD1602指定位置上显示一个字符
  77            * @param  Line 行位置，范围：1~2
  78            * @param  Column 列位置，范围：1~16
  79            * @param  Char 要显示的字符
  80            * @retval 无
  81            */
  82          void LCD_ShowChar(unsigned char Line,unsigned char Column,unsigned char Char)
  83          {
  84   1        LCD_SetCursor(Line,Column);
  85   1        LCD_WriteData(Char);
  86   1      }
  87          
  88          /**
  89            * @brief  在LCD1602指定位置开始显示所给字符串
  90            * @param  Line 起始行位置，范围：1~2
  91            * @param  Column 起始列位置，范围：1~16
  92            * @param  String 要显示的字符串
  93            * @retval 无
  94            */
  95          void LCD_ShowString(unsigned char Line,unsigned char Column,unsigned char String[])
  96          {
  97   1        unsigned char i=0;
  98   1        while(String[i])
  99   1        {
 100   2          LCD_ShowChar(Line,Column++,String[i++]);
 101   2        }
 102   1      }
 103          
 104          /**
 105            * @brief  返回值=X的Y次方
 106            */
 107          unsigned int LCD_power(unsigned char a,unsigned char b)
 108          {
 109   1        unsigned int Result=1;
 110   1        
 111   1        while(b--)
 112   1        {
 113   2          Result*=a;
 114   2        }
 115   1        return Result;
 116   1        
C51 COMPILER V9.54   LCD1602                                                               07/11/2023 11:54:36 PAGE 3   

 117   1      }
 118          
 119          /**
 120            * @brief  在LCD1602指定位置开始显示所给数字
 121            * @param  Line 起始行位置，范围：1~2
 122            * @param  Column 起始列位置，范围：1~16
 123            * @param  Number 要显示的数字，范围：0~65535
 124            * @param  Length 要显示数字的长度，范围：1~5
 125            * @retval 无
 126            */
 127          void LCD_ShowNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
 128          {
 129   1        while(Length--)
 130   1        {
 131   2          LCD_ShowChar(Line,Column++,(Number/LCD_power(10,Length))%10+0x30);
 132   2        }
 133   1      }
 134          
 135          /**
 136            * @brief  在LCD1602指定位置开始以有符号十进制显示所给数字
 137            * @param  Line 起始行位置，范围：1~2
 138            * @param  Column 起始列位置，范围：1~16
 139            * @param  Number 要显示的数字，范围：-32768~32767
 140            * @param  Length 要显示数字的长度，范围：1~5
 141            * @retval 无
 142            */
 143          void LCD_ShowSignedNum(unsigned char Line,unsigned char Column,signed int Number,unsigned char Length)
 144          {
 145   1        unsigned int Number1=0;
 146   1        
 147   1        if(Number>=0)
 148   1        {
 149   2          Number1=Number;
 150   2          LCD_ShowChar(Line,Column++,'+');
 151   2        }
 152   1        else
 153   1        {
 154   2          Number1=-Number;
 155   2          LCD_ShowChar(Line,Column++,'-');
 156   2        }
 157   1        while(Length--)
 158   1        {
 159   2          LCD_ShowChar(Line,Column++,(Number1/LCD_power(10,Length))%10+0x30);
 160   2        }
 161   1      } 
 162          
 163          /**
 164            * @brief  在LCD1602指定位置开始以十六进制显示所给数字
 165            * @param  Line 起始行位置，范围：1~2
 166            * @param  Column 起始列位置，范围：1~16
 167            * @param  Number 要显示的数字，范围：0~0xFFFF
 168            * @param  Length 要显示数字的长度，范围：1~4
 169            * @retval 无
 170            */
 171          void LCD_ShowHexNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
 172          {
 173   1        unsigned char i=0;
 174   1          
 175   1        while(Length--)
 176   1        {
 177   2          i=Number/LCD_power(16,Length)%16;
 178   2          if(i<10)
C51 COMPILER V9.54   LCD1602                                                               07/11/2023 11:54:36 PAGE 4   

 179   2          LCD_ShowChar(Line,Column++,i+0x30);
 180   2          else 
 181   2          LCD_ShowChar(Line,Column++,i+0x41-10);
 182   2        }
 183   1      }
 184          /**
 185            * @brief  在LCD1602指定位置开始以二进制显示所给数字
 186            * @param  Line 起始行位置，范围：1~2
 187            * @param  Column 起始列位置，范围：1~16
 188            * @param  Number 要显示的数字，范围：0~1111 1111 1111 1111
 189            * @param  Length 要显示数字的长度，范围：1~16
 190            * @retval 无
 191            */
 192          void LCD_ShowBinNum(unsigned char Line,unsigned char Column,unsigned int Number,unsigned char Length)
 193          {
 194   1        while(Length--)
 195   1        {
 196   2          LCD_ShowChar(Line,Column++,(Number/LCD_power(2,Length))%2+0x30);
 197   2        }
 198   1      }
 199          
 200          unsigned char array[8][8]={{0x10,0x06,0x09,0x08,0x08,0x09,0x06,0x00}, //字符℃
 201                                     {0x00,0x00,0x00,0x1F,0x00,0x00,0x00,0x00}, //字符一
 202                                     {0x00,0x0E,0x00,0x00,0x00,0x1F,0x00,0x00}, //字符二
 203                                     {0x0E,0x00,0x00,0x0E,0x00,0x00,0x1F,0x00},//字符三
 204                                     {0x1F,0x11,0x15,0x15,0x1F,0x11,0x1F,0x00},//字符四
 205                                     {0x08,0x1F,0x12,0x0F,0x0A,0x1F,0x02,0x00},//字符年
 206                                     {0x0F,0x09,0x0F,0x09,0x0F,0x09,0x13,0x00},//字符月
 207                                     {0x1F,0x11,0x11,0x1F,0x11,0x11,0x1F,0x00}};//字符日
 208          
 209          
 210          /**
 211            * @brief  在LCD1602的CGRAM的0x00~0x07地址处写入自定义符号
 212            * @param  add CGRAM的地址0x00~0x07
 213            * @param  *array 要写入自定义符号的数据，5行8列
 214            * @retval 无
 215            */                           
 216          void LCD_WriteCGRAM(unsigned char add,unsigned char*array)
 217          {
 218   1        unsigned char i=0;
 219   1        add=add<<3;
 220   1        for(i=0;i<8;i++)
 221   1        {
 222   2          LCD_WriteCommand(0x40|add+i);
 223   2          LCD_WriteData(*array++);
 224   2        }
 225   1      }
 226          
 227          /**
 228            * @brief  显示LCD1602CGRAM在0x00~0x07地址的自定义符号
 229            * @param  Line 起始行位置，范围：1~2
 230            * @param  Column 起始列位置，范围：1~16
 231            * @param  add CGRAM的地址0x00~0x07 
 232            * @retval 无
 233            */  
 234          void LCD_ShowCGRAM(unsigned char Line,unsigned char Column,unsigned char add)
 235          {
 236   1        unsigned char i=0;
 237   1        for(i=0;i<8;i++)
 238   1        {
 239   2          LCD_WriteCGRAM(i,array[i]);
 240   2        }
C51 COMPILER V9.54   LCD1602                                                               07/11/2023 11:54:36 PAGE 5   

 241   1        
 242   1        LCD_ShowChar(Line,Column,add);
 243   1      }
 244          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    709    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =     64      41
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
